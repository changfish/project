##############################
###    111261012 張晉瑜    ###
##############################


# prob 6.2.5 --------------------------------------------------------------

sample_mean <- 1747.625
z_0.025 <- qnorm(1-0.025)
lower_b <- sample_mean-350/4*z_0.025
upper_b <- sample_mean+350/4*z_0.025
lower_b
upper_b

# prob 6.3.1 --------------------------------------------------------------
qt(1-0.05/2, 15-1)
qt(1-0.01/2, 24-1)
qt(1-0.1/2, 8-1)
qt(1-0.05/2, 30-1)

# prob 6.3.5 --------------------------------------------------------------
# 0.9
lb <- 71.5-12/4*qt(1-0.1/2, 15)
ub <- 71.5+12/4*qt(1-0.1/2, 15)
lb
ub
# 0.95
lb <- 71.5-12/4*qt(1-0.05/2, 15)
ub <- 71.5+12/4*qt(1-0.05/2, 15)
lb
ub
# 0.99
lb <- 71.5-12/4*qt(1-0.01/2, 15)
ub <- 71.5+12/4*qt(1-0.01/2, 15)
lb
ub

# prob 6.4.6 --------------------------------------------------------------
sp_sq <- ((12-1)*1.05**2+(9-1)*1.01**2)/((12-1)+(9-1))
# 0.95
lb <- (13.21-11)-qt(1-0.05/2, (12-1)+(9-1))*sqrt(sp_sq/12+sp_sq/9)
ub <- (13.21-11)+qt(1-0.05/2, (12-1)+(9-1))*sqrt(sp_sq/12+sp_sq/9)
lb
ub

# 0.99
lb <- (13.21-11)-qt(1-0.01/2, (12-1)+(9-1))*sqrt(sp_sq/12+sp_sq/9)
ub <- (13.21-11)+qt(1-0.01/2, (12-1)+(9-1))*sqrt(sp_sq/12+sp_sq/9)
lb
ub

# prob 6.4.10 -------------------------------------------------------------
data <- read.csv("EXR_C06_S04_10.csv")
nonsmokers <- data$Ca[data$group==1]
smokers <- data$Ca[data$group==2]
t.test(smokers, nonsmokers, var.equal = TRUE, alternative = "greater")

# prob 6.5.1 --------------------------------------------------------------
n <-472
p <- 63/n
lb <- p-qnorm(1-0.05/2)*sqrt(p*(1-p)/n)
ub <- p+qnorm(1-0.05/2)*sqrt(p*(1-p)/n)
lb
ub

# prob 6.5.3 --------------------------------------------------------------
n <-136
p <- 75/n
lb <- p-qnorm(1-0.01/2)*sqrt(p*(1-p)/n)
ub <- p+qnorm(1-0.01/2)*sqrt(p*(1-p)/n)
lb
ub

